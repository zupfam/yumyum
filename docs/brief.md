# Project Brief: YumYum

## Executive Summary

- **Concept:** YumYum is a mobile-first digital storefront that brings the fast, visual, and interactive experience of
  apps like Instagram to the world of hyperlocal food. It focuses on a "reels-style" vertical scrolling menu to maximize
  engagement.
- **Problem:** Street food vendors rely on static, costly printed menus, which prevents dynamic pricing, limits
  upselling, and offers no channel for customer data collection or feedback.
- **Solution:** We provide vendors with a custom-branded, high-performance web app, easily managed. Key features include a dynamic menu, WhatsApp order integration, and a feedback system designed to
  boost positive reviews on social platforms, directly increasing a vendor's visibility and sales.
- **Value Proposition:** For a monthly fee, YumYum gives vendors a powerful tool to increase sales, cut printing costs,
  and build a digital brand, justifying the investment through clear ROI.

## The Analog Trap: How Printed Menus Cost You Money and Customers

Vendors are caught in an "Analog Trap," using outdated paper menus that actively drain profits and lose customers daily.

- **FOR THE VENDOR: The Four Profit Leaks**
    - **1. Direct Printing Costs:**
        - **Pain:** Wasting money on re-printing menus for every small change.
        - **Value:** Eliminate this recurring expense permanently.
    - **2. Zero Upselling, Lost Revenue:**
        - **Pain:** Missing the chance to increase order value with automated suggestions for add-ons or combos.
        - **Value:** Gain a 24/7 digital salesman to boost every customer's bill.
    - **3. No Customer Data, No Repeat Business:**
        - **Pain:** A happy customer leaves forever because you have no way to contact them again.
        - **Value:** Capture customer WhatsApp numbers to drive repeat sales and loyalty.
    - **4. No Social Proof, No Free Marketing:**
        - **Pain:** Good feedback is not captured and converted into 5-star Google reviews that attract new customers.
        - **Value:** Turn your best customers into your most powerful marketing engine.

## Proposed Solution: Your Digital Storefront

We are building YumYum, a beautiful and blazing-fast digital storefront designed specifically for India's hyperlocal
food vendors.

- **FOR THE VENDOR: More Sales, Less Effort**
    - **The Tool:** A custom-branded digital menu that you control and run your digital store.
    - **The Result:**
        - **Increase Sales:** Use a dynamic menu with photos, videos, and upselling prompts to sell more.
        - **Save Money:** Stop printing menus forever. Update prices and items instantly, anytime.
        - **Build Your Brand:** Get a professional, beautiful webpage that builds trust and attracts customers.
        - **Get Customer Data:** Collect WhatsApp numbers to announce offers and bring customers back.

- **FOR THE CUSTOMER: A Modern Menu Experience**
    - **The Tool:** An instant, app-like experience on their phone, accessed via a simple QR code scan.
    - **The Result:**
        - **Visual & Engaging:** A menu that looks and feels like Instagram, with vertical scrolling through dishes.
        - **Always Accurate:** See today's real menu, real prices, and daily specials.
        - **Simple Ordering:** Add items to a cart and place the order directly on the vendor's WhatsApp.

- **OUR KEY DIFFERENTIATOR: Radical Simplicity**
    - While other solutions are complex and expensive, YumYum is built on a single principle: **powerful results from
      simple tools.** We are not just another menu; we are a complete, easy-to-use business growth tool for the street
      food vendor.

## Target Users: Our Core Focus

- ### Primary User Segment: The Ambitious Street Food Vendor
    - **Who they are:** Owner-operators of food stalls, trucks, and small takeaway joints. Not tech-experts, but use
      WhatsApp and Instagram daily.
    - **Their Goal:** To grow their business, increase their daily income, and build a respected local brand.
    - **Their Pains (Our Opportunity):** Frustrated by printing costs, know they could be making more money, and want a
      simple way to get a digital presence.

- ### Secondary User Segment: The Savvy Cloud Kitchen
    - **Who they are:** Delivery-only kitchens reliant on high-commission food aggregator apps.
    - **Their Goal:** To increase profit margins by bypassing high aggregator commissions and building a direct customer
      relationship.
    - **Their Pains (Our Opportunity):** Losing 25-40% of revenue to commissions and having no ownership of their
      customer data.

## Goals & Success Metrics (v2)

- ### 1. Business Objectives (YumYum's Growth)
    - **Phase 1: Rapid Market Entry (Launch - 1 Month)**
        - Onboard **1+ paying vendor** (@ ₹500+ MRR) within **3 days** of launch.
        - Onboard **5+ paying vendors** (@ ₹1k+ MRR) within **1 month**.
    - **Phase 2: Niche Finalization (By Nov 30th)**
        - Analyze data from initial vendors to identify and lock in our most profitable and scalable customer niche.
    - **Phase 3: Niche Domination (Starting Dec 1st)**
        - Become the #1 digital menu provider within our chosen niche and begin exploring strategic collaborations.

- ### 2. Public Growth Objectives (The "Build in Public" Strategy)
    - **Primary Goal:** Document the entire journey to build a personal brand and attract opportunities.
    - **Content Velocity:** Publish **2+ pieces of content** per week.
    - **Audience Growth:** Achieve **1,000+ engaged followers** on a primary social platform within 3 months.
    - **Networking:** Build valuable, authentic connections with other founders, investors, and potential partners.

## MVP Scope: What We Will Build First (v2)

- ### Core Features (Must-Haves for Launch)
    - **1. Vendor Brand Page:** A beautiful, mobile-first digital storefront.
    - **2. Dynamic Menu:** An "Instagram-style" menu controlled by the vendor.
    - **3. Supabase Backend:** Radical simplicity for menu management.
    - **4. QR Code Generator:** The gateway for customers to access the menu.
    - **5. Cart & WhatsApp Ordering:** Closes the order loop using the vendor's existing workflow.
    - **6. Vendor Value Analytics:** A simple, clear report showing the vendor the value they are getting from YumYum.
      This is the tangible **proof of value**.

- ### MVP KPIs & Core Metrics (The Numbers We Will Track)
    - **`menu_views`**: Total unique visitors to the menu.
    - **`top_5_items`**: The most viewed/clicked-on menu items.
    - **`add_to_cart_clicks`**: How many times items are added to a cart.
    - **`order_placed_clicks`**: The critical conversion metric—how many times the "Place Order on WhatsApp" button is
      clicked.
    - **`feedback_clicks`**: How many customers engage with the feedback flow.

## Technical Considerations: The Tech Stack (v3 - Final)

- ### Core Technology Stack
    - **Frontend:** Next.js, Shadcn UI, Aceternity UI, Magic UI.
    - **Backend:** Free supabase tier.
    - **Hosting:** Vercel for our Next.js frontend.

## Operational Playbook & Metrics

- ### Part 1: Pre-Onboarding - Vendor Discovery Questions
    1. "Can you walk me through your process from when a customer arrives to when they leave?"
    2. "Tell me about the last time you had to update your menu or prices. What was that like?"
    3. "What are the biggest day-to-day frustrations you face?"
    4. "Have you ever tried any other digital tools? How did that go?"

- ### Part 2: Post-Onboarding - Key Performance Metrics (15-Day Review)
    - **Vendor Success:** Activation, Menu Richness, Feature Adoption.
    - **Business Health:** MRR, Active Vendors, Churn Rate, CAC.
    - **"Build in Public" Content:** Follower Count, Engagement Rate, Content Velocity.

- ### Part 3: Vendor Success & Feedback Questionnaire (Quarterly Check-in)
    1. "What has been the biggest positive impact on your business from YumYum?"
    2. "Are you seeing more customer feedback or repeat customers?"
    3. "On a scale of 0-10, how likely are you to recommend YumYum?" (NPS)

* **Needs:** They need a single, secure, in-app dashboard to manage their entire digital storefront. Their primary
  requirement is the ability to instantly update menu items, prices, and availability via a simple CRUD interface,
  without ever leaving the application. A secure login is essential to protect their business data.

* **Payment Processing:** For the MVP, all subscription payments will be collected **manually**. No in-app payment
  integration is required.
* **Budget / Infrastructure Cost:** Strictly zero. The solution must operate within free usage tiers.
* **Technical Architecture:** The application must remain a static Jamstack project.
* **Free Tier Viability:** We assume the multi-account strategy is a sustainable way to scale while avoiding costs.

# YumYum Architecture

JamStack with Next.js, Supabase, deployed on Vercel with "Free Tier Maximization" principle.

#### Platform and Infrastructure Choice

* **Key Services:**
    * **Vercel:** Hosting, CI/CD (Free Tier), SEO.
    * **Supabase:** PostgreSQL Database, Authentication (Magic Link), Storage, Auto-generated APIs.
    * **Cloudinary:** Multi-account media hosting and optimization.
    * **Lark:** Webhook for critical alerts.
* **Deployment Host and Regions:** Vercel (Global Edge Network), Supabase (`ap-south-1` Mumbai).

* **Jamstack Architecture:** The frontend remains a pre-rendered application served from a global CDN, with dynamic
  functionality handled by client-side JavaScript interacting with the Supabase backend.
    * *Rationale:* This ensures maximum performance and a great user experience.
* **Backend as a Service (BaaS):** We are leveraging Supabase to provide backend functionality out-of-the-box.
    * *Rationale:* This dramatically reduces backend development time, allowing us to focus on the vendor-facing
      dashboard and features.
* **Row-Level Security (RLS):** All data access will be controlled at the database level using Supabase's RLS policies.
    * *Rationale:* This is a highly secure and scalable way to enforce data isolation between vendors.

---

### Section 3 of 18: Tech Stack

| Category             | Technology                         | Version       | Purpose                                      | Rationale                                                                             |
|:---------------------|:-----------------------------------|:--------------|:---------------------------------------------|:--------------------------------------------------------------------------------------|
| Frontend Language    | TypeScript                         | latest        | Type safety and scalability                  | Industry standard for modern web development, reduces errors.                         |
| Frontend Framework   | Next.js                            | latest        | Core application framework                   | Provides a robust, performant, and scalable foundation for the UI.                    |
| UI Component Library | Shadcn UI, Magic UI, Aceternity UI | latest        | UI components and animations                 | A rich ecosystem to accelerate development and achieve a high-quality, modern finish. |
| State Management     | Zustand                            | latest        | Global state management                      | A small, fast, and scalable solution with a simple hook-based API.                    |
| Backend Language     | TypeScript                         | latest        | Language for Supabase Edge Functions         | To write any necessary server-side logic in a familiar language.                      |
| Backend Framework    | Supabase                           | latest        | Backend as a Service (BaaS)                  | Provides database, auth, and APIs out-of-the-box, accelerating development.           |
| API Style            | REST                               | via PostgREST | Auto-generated APIs for database interaction | Supabase provides a powerful and secure RESTful API layer automatically.              |
| Database             | Supabase (Postgres)                | latest        | Primary data store for premium vendors       | A robust, open-source relational database with excellent performance.                 |
| Cache                | N/A                                | N/A           | Client-side caching will be used             | Caching will be handled at the client level to improve perceived performance.         |
| File Storage         | Cloudinary                         | N/A           | Multi-account media hosting and optimization | A powerful solution for managing and serving images efficiently.                      |
| Authentication       | Supabase Auth                      | latest        | Secure user authentication                   | Provides Magic Link (passwordless) login out-of-the-box.                              |
| Frontend Testing     | Jest & React Testing Library       | latest        | Unit and integration testing                 | Industry-standard tools for testing React applications.                               |
| Backend Testing      | Jest                               | latest        | Testing for Supabase Edge Functions          | To ensure any custom server-side logic is reliable.                                   |
| E2E Testing          | Playwright                         | latest        | End-to-end user flow testing                 | A modern and reliable choice for ensuring critical user journeys work as expected.    |
| Build Tool           | SWC (via Next.js)                  | latest        | Fast code compilation                        | Integrated into Next.js for optimal performance.                                      |
| CI/CD                | Vercel                             | N/A           | Continuous integration & deployment          | Seamlessly integrated with the hosting platform for automated builds and deploys.     |
| Monitoring           | Google Analytics 4                 | N/A           | User behavior and funnel tracking            | Provides essential product engagement KPIs.                                           |
| Logging              | Lark Webhook                       | N/A           | Critical error alerting                      | A simple mechanism to alert the development team of critical failures.                |
| CSS Framework        | Tailwind CSS                       | latest        | Utility-first styling                        | Allows for rapid UI development and easy maintenance.                                 |

---

### Section 7 of 18: External APIs

This section details the external services the YumYum Premium Tier will integrate with.

#### Supabase API

* **Purpose:** Serves as the primary backend for data storage, authentication, and serverless functions.
* **Documentation:** [https://supabase.com/docs](https://supabase.com/docs)
* **Authentication:** API Key and JWT for client-side access.

#### Cloudinary API

* **Purpose:** Hosts, optimizes, and serves all media assets (vendor logos, dish images).
* **Documentation:** [https://cloudinary.com/documentation](https://cloudinary.com/documentation)
* **Authentication:** API Key and Secret for upload operations.

#### Lark Webhook API

* **Purpose:** Used for sending critical system alerts to the development team's communication channel.
* **Documentation:** Specific to the configured incoming webhook URL.
* **Authentication:** None (relies on the secrecy of the webhook URL).

---


### Section 14 of 18: Deployment Architecture

This section outlines the deployment strategy for the YumYum Premium Tier application.

#### Deployment Strategy

* **Platform:** The frontend application is hosted and deployed on **Vercel**. The backend services (database, auth,
  functions) are managed by **Supabase**.
* **Deployment Method:** We use a **Continuous Deployment** model integrated with our Git repository.
    * **Production:** Every push or merge to the `main` branch automatically triggers a build and deployment to the
      production environment.
    * **Previews:** A unique preview deployment is automatically generated for every pull request, allowing for review
      and testing before merging.

#### CI/CD Pipeline

* **Provider:** The CI/CD pipeline is managed entirely by **Vercel**.
* **Build Command:** `pnpm build`
* **Output Directory:** `.next`
* **Framework Preset:** Next.js

#### Database Migrations

* **Tooling:** Supabase database schema changes will be managed using the **Supabase CLI**.
* **Workflow:**
    1. Developers will generate new migration files locally using the CLI.
    2. These migration files will be committed to the repository in the `/supabase/migrations` directory.
    3. When deploying changes to the Supabase backend (e.g., staging or production), these migrations will be applied
       manually using the Supabase CLI to ensure controlled updates.

---

### Section 15 of 18: Security and Performance

This section covers the key strategies for ensuring the application is secure and performant.

#### Security Requirements

Our security model is based on a defense-in-depth approach, leveraging the capabilities of our chosen platforms.

* **Authentication:** All vendor authentication is handled by **Supabase Auth**, using passwordless Magic Links. This
  outsources the complexity of password management and reduces the risk of credential theft.
* **Authorization:** The cornerstone of our data security is **Postgres Row-Level Security (RLS)**. RLS policies,
  defined in Section 11, ensure that a vendor can *only* access and modify their own data. These policies are enforced
  at the database level, providing a robust barrier against unauthorized data access.
* **API Security:** By using the official Supabase client library, we ensure that JWTs are managed securely and
  automatically. All API access is governed by the RLS policies.
* **Secret Management:** All sensitive information, such as API keys and database URLs, are stored as environment
  variables in Vercel and are not exposed to the client-side application.
* **Infrastructure Security:** We rely on Vercel and Supabase to manage infrastructure-level security, including DDoS
  protection, firewalling, and physical security.

#### Performance Optimization

* **Public Pages (SEO):** The public-facing vendor pages (`/[vendor_slug]`) use **Static Site Generation (SSG) with
  Incremental Static Regeneration (ISR)**. This provides extremely fast static pages from the CDN that are perfect for
  SEO, while ensuring data is kept fresh automatically in the background.
* **Authenticated Dashboard (CSR):** The vendor dashboard is a **Client-Side Rendered (CSR)** application. This provides
  a fast, app-like experience after the initial load, as navigation between sections does not require full page reloads.
* **Global CDN:** All static assets and server-rendered pages are cached and served from **Vercel's Global Edge Network
  **, ensuring low latency for users worldwide.
* **Media Optimization:** All images and media assets are served via **Cloudinary**, which provides automatic
  optimization, format selection (e.g., WebP), and CDN delivery.
* **Client-Side Caching:** The application will leverage browser caching and client-side state management (Zustand) to
  minimize redundant data fetching during a user session.

---

### Section 17 of 18: Coding Standards

To ensure a high-quality and consistent codebase, all development must adhere to the following standards.

* **Naming Conventions:**
    * **Components:** `PascalCase` (e.g., `DishCard`, `VendorDashboard`).
    * **Files:** `kebab-case` (e.g., `use-debounce.ts`, `gsheets.ts`).
    * **Functions & Variables:** `camelCase` (e.g., `getDishes`, `vendorId`).
    * **Types & Interfaces:** `PascalCase` (e.g., `VendorMapping`, `Dish`).

---

### Section 18 of 18: Error Handling & Monitoring

#### Monitoring

Our monitoring strategy is focused on three key areas:

1. **Application Performance:**
    * **Tool:** Vercel Analytics.
    * **Purpose:** To monitor Core Web Vitals (LCP, FID, CLS) and overall application performance from the perspective
      of real users.

2. **Critical Failure Alerting:**
    * **Tool:** Lark Webhook.
    * **Purpose:** To provide immediate, real-time alerts to the development team when a critical backend operation
      fails. This is reserved for severe issues that require immediate attention, such as a failure to connect to the
      Supabase database or a critical authentication error.

1. **NFR1:** The entire system architecture must operate within the free tiers of all underlying platforms.
2. **NFR2:** The backend architecture must support a multi-account strategy for Supabase and Cloudinary.
4. **NFR4:** The Supabase backend must enforce Row Level Security (RLS).
5. **NFR5:** The vendor management dashboard shall be a Client-Side Rendered (CSR) application.
6. **NFR6:** For the MVP, all subscription payments shall be collected manually.
7. **NFR7:** For the MVP, all data migration shall be a manual process.
8. **NFR8:** The authentication system must ensure a single user identity, linking new login methods to an existing user
   if they share the same verified email.
9. **NFR9:** Comprehensive documentation must be maintained. A `/wiki` directory will be created at the project root to
   house all technical documentation, workflow guides, and user training materials.

---

### 3. User Interface Design Goals

* **Overall UX Vision:** To provide a simple, clean, and highly efficient in-app dashboard that makes menu and brand
  management feel effortless.
* **Key Interaction Paradigms:** The dashboard will use standard UI patterns: simple forms, tables/lists for viewing,
  and clear buttons for actions.
* **Core Screens and Views:**
    1. Login Page (for Magic Link)
    2. Vendor Dashboard , use vendor slugs (`domain/slug`)
    3. Landing Page
* **Accessibility:** WCAG 2.1 Level AA
* **Target Device and Platforms:** Web Responsive (Mobile & Desktop).

---
### Section 9 of 18: Database Schema (v3)

This section provides the SQL schema for the tables in our Supabase Postgres database, now including custom `ENUM` types
for data integrity.

```sql
-- Create ENUM types first
CREATE TYPE instock_status AS ENUM ('yes', 'no', 'hide');
CREATE TYPE veg AS ENUM ('veg', 'non-veg');
CREATE TYPE status_type AS ENUM ('image', 'video', 'text');

-- In the PRIMARY Supabase project
-- This table maps a vendor to their dedicated Supabase project and Cloudinary account.
CREATE TABLE public.vendor_mappings
(
    id                    bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    vendor_slug           text                     NOT NULL UNIQUE,
    backend_type          text                     NOT NULL, -- 'supabase' or 'gsheets'
    supabase_project_id   text,
    gsheet_id             text,
    cloudinary_account_id text                     NOT NULL,
    created_at            timestamp with time zone NOT NULL DEFAULT now()
);

-----------------------------------------------------------------

-- In EACH of the 4 VENDOR Supabase projects
-- Stores the vendor's brand profile information.
CREATE TABLE public.brand
(
    id         bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    vendor_id  uuid                     NOT NULL REFERENCES auth.users (id),
    name       text                     NOT NULL,
    -- ... other brand fields
    created_at timestamp with time zone NOT NULL DEFAULT now()
);

-- Stores the individual menu items for a vendor.
CREATE TABLE public.dishes
(
    id          bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    vendor_id   uuid                     NOT NULL REFERENCES auth.users (id),
    category    text                     NOT NULL,
    name        text                     NOT NULL,
    description text,
    price       real,
    instock     instock_status                    DEFAULT 'yes', -- Use ENUM type
    veg         dietary_info,                                    -- Use ENUM type
    tag         text,
    image       text,
    reel        text,
    created_at  timestamp with time zone NOT NULL DEFAULT now()
);

-- Stores daily status updates from the vendor.
CREATE TABLE public.status
(
    id         bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    vendor_id  uuid                     NOT NULL REFERENCES auth.users (id),
    content    text                     NOT NULL,
    type       status_type              NOT NULL, -- Use ENUM type
    created_at timestamp with time zone NOT NULL DEFAULT now()
);
```

---



### Section 4 of 18: Data Models (v2)

#### `vendor_mappings`

* **Purpose:** To act as the master directory for all vendors. It will determine whether a vendor's data is on Google
  Sheets or Supabase and provide the necessary connection info.
* **TypeScript Interface:**
  ```typescript
  export type BackendType = 'supabase' | 'gsheets';

  export interface VendorMapping {
    id: number;
    vendor_slug: string; // e.g., 'the-burger-den'
    backend_type: BackendType; // 'supabase' or 'gsheets'
    
    // Supabase-specific fields
    supabase_project_id?: string; // Which of the 4 Supabase projects
    
    // Google Sheets-specific fields
    gsheet_id?: string;

    // Cloudinary account is common to both
    cloudinary_account_id: string; // Which of the 4 Cloudinary accounts
  }
  ```

#### `Brand`

* **Purpose:** Represents the vendor's brand identity.
* **TypeScript Interface:** (No changes from previous version)
  ```typescript
  export interface Brand {
    id: number;
    vendor_id: string; // Foreign Key to auth.users.id
    // ... all other brand fields
  }
  ```

#### `Dish`

* **Purpose:** Represents a single menu item.
* **TypeScript Interface (Updated):**
  ```typescript
  export interface Dish {
    id: number;
    vendor_id: string; // Foreign Key to auth.users.id
    category: string;
    name: string;
    description: string | null;
    price: number | null;
    instock: 'yes' | 'no' | 'hide' | null;
    veg: 'veg' | 'non-veg' | null;
    tag: string | null;
    image: string | null;
    reel: string | null;
    created_at: string;
  }
  ```

#### `Status`

* **Purpose:** Represents a daily status update.
* **TypeScript Interface:** (No changes from previous version)
  ```typescript
  export interface Status {
    id: number;
    vendor_id: string; // Foreign Key to auth.users.id
    content: string;
    type: 'image' | 'video' | 'text';
  }
  ```

---